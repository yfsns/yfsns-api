import{j as e}from"./index-C42INjwk.js";import{j as U,f as H,r as S}from"./react-vendor-CKx6dMfn.js";import{u as X}from"./usePluginManagement-Ct7hxFZi.js";import{F as i,a3 as u,a4 as o,a5 as C,i as b,K as y,I as j,o as m,G as A,S as F,B as d,H as Y,J as B,T as Z,a6 as x,a7 as O,r as _,w as K,z as ee,W as ae,X as se,a8 as te,a9 as le,p as ne,aa as re,ab as ie,k as q,Y as R,Z as oe,s as ce}from"./antd-vendor-DaJANQRB.js";import"./redux-vendor-DakFfX2h.js";import"./index-CPCCNLS5.js";const{Title:pe,Text:ue,Paragraph:ge}=Z,{Option:n}=m,{TextArea:g}=j,{TabPane:ve}=O,{Panel:de}=C,we=()=>{var I;const{pluginId:v}=U(),$=H(),[p]=i.useForm(),[E,G]=S.useState("basic"),{pluginList:L,loading:M}=X(),t=L.find(a=>a.id===v),h=v==="new",z=a=>{const s={auth:[{name:"enableOAuth",label:"启用OAuth登录",type:"switch",description:"允许用户通过第三方平台登录",group:"basic"},{name:"oauthProviders",label:"OAuth提供商",type:"checkbox",options:[{label:"微信",value:"wechat"},{label:"QQ",value:"qq"},{label:"支付宝",value:"alipay"},{label:"GitHub",value:"github"},{label:"Google",value:"google"}],group:"basic"},{name:"sessionTimeout",label:"会话超时时间(分钟)",type:"number",props:{min:1,max:1440},description:"用户登录会话的有效期",group:"security"},{name:"maxLoginAttempts",label:"最大登录尝试次数",type:"number",props:{min:1,max:10},group:"security"},{name:"passwordPolicy",label:"密码策略",type:"json",description:"密码复杂度要求配置",group:"security",advanced:!0}],content:[{name:"enableAutoSave",label:"启用自动保存",type:"switch",group:"basic"},{name:"autoSaveInterval",label:"自动保存间隔(秒)",type:"number",props:{min:10,max:300},dependencies:["enableAutoSave"],group:"basic"},{name:"maxFileSize",label:"最大文件大小(MB)",type:"number",props:{min:1,max:1e3},group:"upload"},{name:"allowedFileTypes",label:"允许的文件类型",type:"select",props:{mode:"multiple"},options:[{label:"图片",value:"image"},{label:"视频",value:"video"},{label:"音频",value:"audio"},{label:"文档",value:"document"},{label:"压缩包",value:"archive"}],group:"upload"},{name:"contentFilters",label:"内容过滤器",type:"table",description:"配置内容过滤规则",group:"content",advanced:!0}],notification:[{name:"enablePush",label:"启用推送通知",type:"switch",group:"basic"},{name:"enableEmail",label:"启用邮件通知",type:"switch",group:"basic"},{name:"enableSms",label:"启用短信通知",type:"switch",group:"basic"},{name:"pushSettings",label:"推送设置",type:"json",description:"推送服务的详细配置",group:"notification",advanced:!0},{name:"emailTemplate",label:"邮件模板",type:"code",props:{language:"html"},group:"notification",advanced:!0}],analytics:[{name:"trackPageViews",label:"跟踪页面访问",type:"switch",group:"basic"},{name:"trackUserBehavior",label:"跟踪用户行为",type:"switch",group:"basic"},{name:"dataRetentionDays",label:"数据保留天数",type:"number",props:{min:1,max:365},group:"data"},{name:"reportFrequency",label:"报告生成频率",type:"select",options:[{label:"每日",value:"daily"},{label:"每周",value:"weekly"},{label:"每月",value:"monthly"}],group:"data"},{name:"customMetrics",label:"自定义指标",type:"table",description:"定义需要跟踪的自定义指标",group:"analytics",advanced:!0}],payment:[{name:"enableAlipay",label:"启用支付宝",type:"switch",group:"basic"},{name:"enableWechatPay",label:"启用微信支付",type:"switch",group:"basic"},{name:"transactionFee",label:"交易手续费(%)",type:"slider",props:{min:0,max:10,step:.1},group:"finance"},{name:"refundPolicy",label:"退款政策",type:"textarea",description:"退款规则和条件说明",group:"finance"},{name:"webhookUrl",label:"Webhook地址",type:"input",placeholder:"https://example.com/webhook",group:"integration",advanced:!0}],default:[{name:"enabled",label:"启用插件",type:"switch",group:"basic"},{name:"priority",label:"优先级",type:"number",props:{min:1,max:100},description:"插件执行优先级，数值越小优先级越高",group:"basic"},{name:"description",label:"插件描述",type:"textarea",group:"basic"},{name:"version",label:"版本号",type:"input",group:"info"},{name:"author",label:"作者",type:"input",group:"info"}]};return s[a||"default"]||s.default},w=a=>{var r,c,f,T,P;const s={placeholder:a.placeholder,disabled:(r=a.dependencies)==null?void 0:r.some(l=>!p.getFieldValue(l))};switch(a.type){case"input":return e.jsx(j,{...s});case"textarea":return e.jsx(g,{...s,rows:4});case"number":return e.jsx(oe,{...s,...a.props,style:{width:"100%"}});case"switch":return e.jsx(A,{...s});case"select":return e.jsx(m,{...s,...a.props,children:(c=a.options)==null?void 0:c.map(l=>e.jsx(n,{value:l.value,children:l.label},l.value))});case"radio":return e.jsx(R.Group,{...s,children:(f=a.options)==null?void 0:f.map(l=>e.jsx(R,{value:l.value,children:l.label},l.value))});case"checkbox":return e.jsx(q.Group,{...s,children:e.jsx(u,{children:(T=a.options)==null?void 0:T.map(l=>e.jsx(o,{span:8,children:e.jsx(q,{value:l.value,children:l.label})},l.value))})});case"slider":return e.jsx(ie,{...s,...a.props});case"color":return e.jsx(re,{...s});case"date":return e.jsx(ne,{...s,style:{width:"100%"}});case"time":return e.jsx(le,{...s,style:{width:"100%"}});case"rate":return e.jsx(te,{...s,...a.props});case"upload":return e.jsx(ae,{...s,children:e.jsx(d,{icon:e.jsx(se,{}),children:"上传文件"})});case"json":return e.jsx(g,{...s,rows:6,placeholder:"请输入JSON格式的配置"});case"code":return e.jsx(g,{...s,rows:10,placeholder:`请输入${((P=a.props)==null?void 0:P.language)||"代码"}`});case"table":return e.jsx(_,{dataSource:[],columns:[{title:"名称",dataIndex:"name",key:"name"},{title:"值",dataIndex:"value",key:"value"},{title:"操作",key:"action",render:()=>e.jsxs(F,{children:[e.jsx(d,{size:"small",icon:e.jsx(K,{}),children:"编辑"}),e.jsx(d,{size:"small",icon:e.jsx(ee,{}),children:"删除"})]})}],pagination:!1,size:"small"});default:return e.jsx(j,{...s})}},N=a=>{const s={};return a.forEach(r=>{const c=r.group||"basic";s[c]||(s[c]=[]),s[c].push(r)}),s};S.useEffect(()=>{t&&!h?p.setFieldsValue({...t,enabled:t.status==="active"}):h&&p.setFieldsValue({enabled:!1,priority:50,version:"1.0.0"})},[t,h,p]);const Q=async()=>{ce.info("插件编辑功能暂不可用")},D=()=>{$("/plugin/list")},V=z(t==null?void 0:t.type),k=N(V),W=a=>({security:"安全设置",upload:"上传配置",content:"内容配置",notification:"通知配置",data:"数据配置",analytics:"分析配置",finance:"财务配置",integration:"集成配置",info:"插件信息"})[a]||a,J=[{key:"basic",label:"基础配置",children:e.jsx(u,{gutter:16,children:(I=k.basic)==null?void 0:I.map((a,s)=>e.jsx(o,{span:12,children:e.jsx(i.Item,{name:a.name,label:a.label,rules:a.required?[{required:!0,message:`请输入${a.label}`}]:[],tooltip:a.description,children:w(a)})},s))})},{key:"advanced",label:"高级配置",children:e.jsx(C,{defaultActiveKey:["1"],children:Object.entries(k).map(([a,s])=>a==="basic"?null:e.jsx(de,{header:W(a),children:e.jsx(u,{gutter:16,children:s.map((r,c)=>e.jsx(o,{span:12,children:e.jsx(i.Item,{name:r.name,label:r.label,rules:r.required?[{required:!0,message:`请输入${r.label}`}]:[],tooltip:r.description,children:w(r)})},c))})},a))})},{key:"api",label:"API接口",children:e.jsxs(b,{children:[e.jsx(y,{message:"API接口配置",description:"配置插件的API接口参数和权限",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(i.Item,{label:"API端点",children:e.jsx(j,{placeholder:"https://api.example.com/plugin"})}),e.jsx(i.Item,{label:"认证方式",children:e.jsxs(m,{children:[e.jsx(n,{value:"none",children:"无认证"}),e.jsx(n,{value:"api_key",children:"API密钥"}),e.jsx(n,{value:"oauth",children:"OAuth 2.0"}),e.jsx(n,{value:"jwt",children:"JWT Token"})]})})]})},{key:"database",label:"数据库",children:e.jsxs(b,{children:[e.jsx(y,{message:"数据库配置",description:"配置插件需要的数据表和字段",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(i.Item,{label:"数据库类型",children:e.jsxs(m,{children:[e.jsx(n,{value:"mysql",children:"MySQL"}),e.jsx(n,{value:"postgresql",children:"PostgreSQL"}),e.jsx(n,{value:"sqlite",children:"SQLite"}),e.jsx(n,{value:"mongodb",children:"MongoDB"})]})})]})},{key:"security",label:"安全设置",children:e.jsxs(b,{children:[e.jsx(y,{message:"安全配置",description:"配置插件的安全参数和权限控制",type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsxs(u,{gutter:16,children:[e.jsx(o,{span:12,children:e.jsx(i.Item,{label:"访问权限",name:"accessLevel",children:e.jsxs(m,{children:[e.jsx(n,{value:"public",children:"公开"}),e.jsx(n,{value:"authenticated",children:"需要登录"}),e.jsx(n,{value:"admin",children:"管理员"}),e.jsx(n,{value:"custom",children:"自定义"})]})})}),e.jsx(o,{span:12,children:e.jsx(i.Item,{label:"数据加密",name:"encryption",valuePropName:"checked",children:e.jsx(A,{})})})]})]})}];return e.jsx("div",{children:e.jsxs(b,{children:[e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsxs(F,{children:[e.jsx(d,{icon:e.jsx(Y,{}),onClick:D,children:"返回"}),e.jsx(B,{type:"vertical"}),e.jsx(pe,{level:3,style:{margin:0},children:h?"新建插件":`编辑插件 - ${t==null?void 0:t.name}`})]}),(t==null?void 0:t.description)&&e.jsx(ue,{type:"secondary",style:{display:"block",marginTop:"8px"},children:t.description})]}),t&&e.jsx("div",{style:{marginBottom:"24px"},children:e.jsxs(u,{gutter:16,children:[e.jsx(o,{span:6,children:e.jsx(x,{title:"插件状态",value:t.status})}),e.jsx(o,{span:6,children:e.jsx(x,{title:"版本",value:t.version})}),e.jsx(o,{span:6,children:e.jsx(x,{title:"作者",value:t.author})}),e.jsx(o,{span:6,children:e.jsx(x,{title:"安装次数",value:t.downloads})})]})}),e.jsxs(i,{form:p,layout:"vertical",onFinish:Q,children:[e.jsx(O,{activeKey:E,onChange:G,items:J}),e.jsx(B,{}),e.jsx("div",{style:{textAlign:"left"},children:e.jsx(d,{type:"primary",htmlType:"submit",loading:M,children:"保存"})})]})]})})};export{we as default};
