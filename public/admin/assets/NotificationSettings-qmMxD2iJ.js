import{j as t}from"./index-C42INjwk.js";import{r,f as h}from"./react-vendor-CKx6dMfn.js";import{t as p}from"./templateApi-ZVFdlWP0.js";import{s as u}from"./index-CPCCNLS5.js";import{s as f,i as j,r as i,k as x,S as w,B as g,w as C,T as y}from"./antd-vendor-DaJANQRB.js";import"./redux-vendor-DakFfX2h.js";const T=()=>{const[c,o]=r.useState([]),[m,l]=r.useState(!1),e=r.useCallback(async()=>{l(!0);try{const d=((await p.fetchList()).list||[]).map(s=>({...s,description:s.remark}));o(d)}catch{u("获取通知模板失败"),o([])}finally{l(!1)}},[]),n=r.useCallback(async a=>{try{return a.id?(await p.update(a.id,a),f.success("模板更新成功"),await e(),!0):(u("模板只能通过数据库创建，不支持通过界面创建"),!1)}catch{return u("保存失败，请重试"),!1}},[e]);return r.useEffect(()=>{e()},[e]),{templateList:c,templateLoading:m,fetchTemplates:e,handleSaveTemplate:n}},{Title:E,Text:B}=y,M=()=>{const c=h(),{templateList:o,templateLoading:m}=T(),l=e=>{c(`/system/notification/edit/${e.id}`)};return t.jsx("div",{style:{padding:"12px"},children:t.jsx(j,{title:"通知模板管理",style:{marginBottom:"24px"},children:t.jsxs(i,{dataSource:o||[],rowKey:"id",pagination:!1,bordered:!0,loading:m,children:[t.jsx(i.Column,{title:"ID",dataIndex:"id",width:60},"id"),t.jsx(i.Column,{title:"模板名称",dataIndex:"name",width:140},"name"),t.jsx(i.Column,{title:"模板代码",dataIndex:"code",width:120},"code"),t.jsx(i.Column,{title:"渠道",dataIndex:"channels",width:150,render:e=>{const n=["database","mail","sms"],a={database:"数据库",mail:"邮件",sms:"短信"},d=new Set(e||[]);return t.jsx(x.Group,{value:e,disabled:!0,children:t.jsx(w,{size:"small",children:n.map(s=>t.jsx(x,{value:s,checked:d.has(s),children:a[s]||s},s))})})}},"channels"),t.jsx(i.Column,{title:"状态",dataIndex:"status",width:80,render:e=>e?"启用":"禁用"},"status"),t.jsx(i.Column,{title:"操作",width:100,render:(e,n)=>t.jsx(g,{size:"small",icon:t.jsx(C,{}),onClick:()=>l(n),children:"编辑"})},"action")]})})})};export{M as default};
