import{i as a,j as e}from"./index-C42INjwk.js";import{r as d}from"./react-vendor-CKx6dMfn.js";import{s as g}from"./index-CPCCNLS5.js";import{s as C,F as o,i as b,a3 as h,a4 as c,k as r,Y as u,Z as x,B as v,$ as A}from"./antd-vendor-DaJANQRB.js";import"./redux-vendor-DakFfX2h.js";const f={getAuthConfig:()=>a.get("/api/admin/config/auth").then(t=>t.data),updateAuthConfig:t=>a.put("/api/admin/config/auth",t),getGroupConfig:t=>a.get(`/api/admin/config/${t}`).then(i=>i.data),updateGroupConfig:(t,i)=>a.put(`/api/admin/config/${t}`,i),fetchConfig:(t,i="auth")=>a.get("/api/admin/config/show",{params:{key:t,group:i}}).then(s=>s.data),updateConfig:(t,i,s="auth")=>a.post("/api/admin/config/set",{key:t,value:i,group:s}),batchSetConfigs:t=>a.post("/api/admin/config/batch-set",{configs:t}),groupConfig:(t="auth")=>a.get("/api/admin/config/group",{params:{group:t}}).then(i=>i.data),groupList:(t="auth")=>a.get("/api/admin/config/group-list",{params:{group:t}}).then(i=>i.data)},L=t=>{const[i,s]=d.useState(!1),[m,j]=d.useState(null),p=async()=>{s(!0);try{const n=await f.getAuthConfig(),l={...n,loginAttemptsLimit:Number(n.loginAttemptsLimit)||5,loginLockoutDuration:Number(n.loginLockoutDuration)||900};j(l),t.setFieldsValue(l)}catch{g("获取认证配置失败")}finally{s(!1)}},y=async n=>{s(!0);try{const l={...n,loginAttemptsLimit:Number(n.loginAttemptsLimit),loginLockoutDuration:Number(n.loginLockoutDuration)};await f.updateAuthConfig(l),await p(),C.success("认证配置保存成功")}catch{g("保存失败，请重试")}finally{s(!1)}};return d.useEffect(()=>{p()},[]),{loading:i,config:m,saveConfig:y}},F=()=>{const[t]=o.useForm(),{loading:i,config:s,saveConfig:m}=L(t);return e.jsx("div",{style:{padding:"12px"},children:e.jsx(b,{style:{marginBottom:"24px"},children:e.jsxs(o,{form:t,layout:"vertical",onFinish:m,initialValues:s||{},style:{maxWidth:800},children:[e.jsxs(h,{gutter:16,children:[e.jsx(c,{span:12,children:e.jsx(o.Item,{name:"registrationMethods",label:"注册方式",children:e.jsx(r.Group,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsx(r,{value:"username",children:"用户名注册"}),e.jsx(r,{value:"email",children:"邮箱注册"}),e.jsx(r,{value:"sms",children:"短信注册"})]})})})}),e.jsx(c,{span:12,children:e.jsx(o.Item,{name:"loginMethods",label:"登录方式",children:e.jsx(r.Group,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsx(r,{value:"username",children:"用户名密码登录"}),e.jsx(r,{value:"email",children:"邮箱验证码登录"}),e.jsx(r,{value:"sms",children:"短信验证码登录"})]})})})})]}),e.jsx(o.Item,{name:"passwordStrength",label:"密码强度要求",rules:[{required:!0,message:"请选择密码强度要求"}],children:e.jsx(u.Group,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsx(u,{value:"weak",children:"弱密码（长度≥6）"}),e.jsx(u,{value:"medium",children:"中等密码（字母+数字，长度≥6）"}),e.jsx(u,{value:"strong",children:"强密码（大小写+数字+符号，长度≥8）"})]})})}),e.jsxs(h,{gutter:16,children:[e.jsx(c,{span:12,children:e.jsx(o.Item,{name:"loginAttemptsLimit",label:"登录失败最大尝试次数",rules:[{required:!0,message:"请输入登录失败最大尝试次数"},{type:"number",min:1,max:20,message:"尝试次数必须在1-20之间"}],children:e.jsx(x,{min:1,max:20,placeholder:"请输入尝试次数",style:{width:"100%"}})})}),e.jsx(c,{span:12,children:e.jsx(o.Item,{name:"loginLockoutDuration",label:"登录锁定持续时间（秒）",rules:[{required:!0,message:"请输入登录锁定持续时间"},{type:"number",min:60,max:3600,message:"锁定时间必须在60-3600秒之间"}],children:e.jsx(x,{min:60,max:3600,placeholder:"请输入锁定时间（秒）",style:{width:"100%"}})})})]}),e.jsx(o.Item,{style:{marginTop:"24px"},children:e.jsx(v,{type:"primary",icon:e.jsx(A,{}),loading:i,htmlType:"submit",size:"large",children:"保存配置"})})]})})})};export{F as default};
