import{j as e}from"./index-C42INjwk.js";import{f as z,r as b}from"./react-vendor-CKx6dMfn.js";import{u as C}from"./usePluginManagement-Ct7hxFZi.js";import{S as n,T as a,u as h,v as S,G as _,B as l,ag as x,i as T,r as w,O as v,s as P}from"./antd-vendor-DaJANQRB.js";import"./redux-vendor-DakFfX2h.js";import"./index-CPCCNLS5.js";const F=()=>{const g=z(),{pluginList:p,loading:i,fetchPlugins:j,handleTogglePlugin:d,handleInstallPlugin:r,uninstallPlugin:o}=C(),c=t=>{g(`/plugin/${t.name}/config`)},m=()=>{j(),P.success("插件列表已刷新")},y=b.useMemo(()=>[{title:"插件",key:"plugin",render:(t,s)=>e.jsxs(n,{direction:"vertical",size:2,children:[e.jsx(a.Text,{strong:!0,children:s.name}),e.jsxs(n,{size:6,wrap:!0,children:[e.jsxs(a.Text,{type:"secondary",style:{fontSize:12},children:["v",s.version]}),s.author&&e.jsxs(a.Text,{type:"secondary",style:{fontSize:12},children:["· ",s.author]})]}),s.category&&e.jsx(h,{color:"blue",children:s.category}),s.hasConfig!==!1&&e.jsx(h,{color:"green",style:{fontSize:10},children:"可配置"})]})},{title:"描述",dataIndex:"description",key:"description",ellipsis:!0,render:t=>e.jsx(S,{title:t,children:e.jsx(a.Text,{type:"secondary",children:t||"-"})})},{title:"状态",key:"status",width:150,render:(t,s)=>{const u={not_uploaded:{text:"未上传",color:"default"},not_installed:{text:"未安装",color:"orange"},installed_enabled:{text:"已启用",color:"green"},installed_disabled:{text:"已禁用",color:"red"}},{text:k,color:f}=u[s.installStatus]||{text:"未知",color:"default"};return s.installStatus==="installed_enabled"||s.installStatus==="installed_disabled"?e.jsx(_,{checked:s.installStatus==="installed_enabled",loading:s.status==="installing"||i,checkedChildren:"启用",unCheckedChildren:"禁用",onChange:()=>d(s.id),disabled:s.status==="error"}):e.jsx(h,{color:f,children:k})}},{title:"操作",key:"action",width:200,render:(t,s)=>{const{installStatus:u}=s;if(s.status==="installing")return e.jsx(l,{type:"link",size:"small",loading:!0,disabled:!0,children:"安装中"});if(s.status==="error")return e.jsx(l,{type:"link",size:"small",danger:!0,icon:e.jsx(x,{}),onClick:()=>r(s.id),children:"重试安装"});switch(u){case"not_uploaded":return null;case"not_installed":return e.jsx(l,{type:"link",size:"small",icon:e.jsx(x,{}),onClick:()=>r(s.id),disabled:i,children:"安装"});case"installed_enabled":return e.jsxs(n,{size:4,children:[e.jsx(l,{type:"link",size:"small",onClick:()=>d(s.id),disabled:i,children:"禁用"}),e.jsx(l,{type:"link",size:"small",onClick:()=>c(s),children:"配置"}),e.jsx(l,{type:"link",size:"small",danger:!0,onClick:()=>o(s.name),disabled:i,children:"卸载"})]});case"installed_disabled":return e.jsxs(n,{size:4,children:[e.jsx(l,{type:"link",size:"small",onClick:()=>d(s.id),disabled:i,children:"启用"}),e.jsx(l,{type:"link",size:"small",onClick:()=>c(s),children:"配置"}),e.jsx(l,{type:"link",size:"small",danger:!0,onClick:()=>o(s.name),disabled:i,children:"卸载"})]});default:return null}}}],[c,r,d,o,i]);return e.jsx("div",{children:e.jsxs(T,{title:"插件管理",extra:e.jsx(n,{children:e.jsx(l,{icon:e.jsx(v,{}),onClick:m,children:"刷新"})}),children:[e.jsx("div",{style:{marginBottom:16},children:e.jsx(a.Text,{type:"secondary",children:"管理已安装的插件，可快速启用、配置或卸载。"})}),e.jsx(w,{columns:y,dataSource:p,rowKey:"id",loading:i,pagination:{showSizeChanger:!0,showQuickJumper:!0,showTotal:(t,s)=>`第 ${s[0]}-${s[1]} 条/共 ${t} 条`},size:"small",bordered:!0})]})})};export{F as default};
